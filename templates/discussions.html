<!-- discussions.html -->
{% extends "base.html" %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block content_container %}

<div class="row">

    <div class="col-md-10">
    	<legend>Discussions</legend>
    	<div id="thread_display"> 
			<dl id="posts">  			
				
			<!-- thread header -->
			    <dt class="thread_head">
			    	<h2><a href="#">{{ thread.subject }}</a></h2>
			    	<small>{{ thread.creator }}</small>
			    	<small style="float: right">{{ thread.modified|date:"M j Y" }}</small>
			    </dt>
			<!-- end thread header -->	
			
			<!-- thread body -->
			    <dd>{{ thread.text }}</dd>

		        <div class="well">
			        <form id="{{thread.id}}-postform" class="postform" action="{% url 'create_post'%}" method="post" data-reply_target="{{thread.id}}-replies">{% csrf_token %}
			            {{ postform|crispy }}
			            <p><input id="post_submit_btn" type="submit" class="btn btn-default" value="Add Post"/></p>
			        </form>
		        </div>
		        
		        <!-- Replies -->
		        <dl id="{{thread.id}}-replies" class="reply-block">		    
			    {% for j in replies  %}
				    <div class="well" style="margin-left: 30px">
				    	<dt>
				    		{{ j.subject }}
				    		<small>{{ j.creator }}</small>
				    		<small style="float: right">{{ j.modified|date:"M j Y" }}</small>
				    		
				    	</dt>
				    	<dd>{{ j.text }}</dd>
				    </div>
			    {% endfor %}
				</dl>
				<!-- end thread body -->
				

			
			</dl>
		</div>
	</div>	
    
    <div class="col-md-2">
    	<legend>Threads</legend>
    	<div class="row">
			<div class="col-md-12 button-group">
			{% for i in thread_list  %}
				<a href="{% url 'discussion_select' i.slug %}"><div class="button">{{i.subject}}</div></a>
				<a href="{{ i.lesson_post.all.0.lesson.get_absolute_url }}">({{ i.lesson_post.all.0.lesson }})</a>
			{% endfor %}
				<a href="{% url 'discussion' %}"><div class="button"> All </div></a>
			</div>	
		</div>
    </div>

</div>

{% endblock content_container %}

 
{% block js_include %} <script src="{% static 'js/discussions.js' %}"></script>{% endblock js_include %}

